<form (submit)="submitForm($event)">
  @let titleInvalid = isInvalid(bookForm.title);
  <label for="title">Title</label>
  <input
    type="text"
    id="title"
    [field]="bookForm.title"
    [attr.aria-describedby]="titleInvalid ? 'title-error' : null"
    [attr.aria-invalid]="titleInvalid"
  />
  @if (titleInvalid) {
  <small id="title-error">The title is invalid.</small>
  }

  <label for="subtitle">Subtitle</label>
  <input type="text" id="subtitle" [field]="bookForm.subtitle" />

  @let isbnInvalid = isInvalid(bookForm.isbn);
  <label for="isbn">ISBN</label>
  <input
    type="text"
    id="isbn"
    [field]="bookForm.isbn"
    [attr.aria-describedby]="isbnInvalid ? 'isbn-error' : null"
    [attr.aria-invalid]="isbnInvalid"
  />
  @if (isbnInvalid) {
  <small id="isbn-error">The ISBN is invalid.</small>
  }

  <fieldset>
    <legend>Authors</legend>
    <button type="button" (click)="addAuthorControl()">Add Author</button>
    @let authorsInvalid = isInvalid(bookForm.authors);
    <div role="group">
      @for (authorControl of bookForm.authors; track $index) {
      <input
        type="text"
        [attr.aria-label]="`Author ${$index + 1}`"
        [field]="authorControl"
        [attr.aria-describedby]="authorsInvalid ? 'authors-error' : null"
        [attr.aria-invalid]="authorsInvalid"
      />
      }
      @if (authorsInvalid) {
      <small id="authors-error">At least one author must be added.</small>
      }
    </div>

  </fieldset>

  @let descriptionInvalid = isInvalid(bookForm.description);
  <label for="description">Description</label>
  <textarea
    id="description"
    [field]="bookForm.description"
    [attr.aria-describedby]="descriptionInvalid ? 'description-error' : null"
    [attr.aria-invalid]="descriptionInvalid">
  </textarea>
  @if (descriptionInvalid) {
  <small id="description-error">The description is invalid.</small>
  }

  @let imageUrlInvalid = isInvalid(bookForm.imageUrl);
  <label for="imageUrl">Thumbnail URL</label>
  <input
    type="url"
    id="imageUrl"
    [field]="bookForm.imageUrl"
    [attr.aria-describedby]="imageUrlInvalid ? 'image-url-error' : null"
    [attr.aria-invalid]="imageUrlInvalid" />
  @if (imageUrlInvalid) {
  <small id="image-url-error">The URL is invalid.</small>
  }

  <button
    type="submit"
    [disabled]="bookForm().invalid()"
    [attr.aria-busy]="bookForm().submitting()">
    Save
  </button>
</form>
