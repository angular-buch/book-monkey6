import{a as M,b as $,c as O,d as q,e as j,f as z,g as G,h as H,i as k}from"./chunk-OSOC4JH4.js";import{a as J}from"./chunk-ZXYNXMVG.js";import{D as n,E as I,I as s,J as p,L as c,M as b,N as v,O as f,P as x,Q as P,R as w,S as A,T as t,U as o,W as U,X as F,Y as D,Z as a,a as E,b as B,ba as L,ca as R,da as V,q as S,s as y,t as h,ua as N,y as T}from"./chunk-5M75ONTP.js";function K(i,r){i&1&&(t(0,"small",3),a(1,"The title is invalid."),o())}function Q(i,r){i&1&&(t(0,"small",8),a(1,"The ISBN is invalid."),o())}function W(i,r){if(i&1&&(t(0,"input",11),c(),o()),i&2){let d=r.$implicit,e=r.$index;D();let l=V(19);s("aria-label",`Author ${e+1}`),b(d),s("aria-invalid",l),p("aria-describedby",l?"authors-error":null)}}function X(i,r){i&1&&(t(0,"small",12),a(1,"At least one author must be added."),o())}function Y(i,r){i&1&&(t(0,"small",15),a(1,"The description is invalid."),o())}function Z(i,r){i&1&&(t(0,"small",18),a(1,"The URL is invalid."),o())}var ee=z(i=>{k(i.title),k(i.isbn),H(i.isbn,13),G(i.isbn,13),$(i.authors,r=>r.value().some(d=>d)?void 0:M({kind:"atLeastOneAuthor"})),k(i.description),k(i.imageUrl)}),g=class i{#e=S(J);#i=S(N);#t=T({isbn:"",title:"",subtitle:"",authors:[""],description:"",imageUrl:"",createdAt:new Date().toISOString()});bookForm=q(this.#t,ee);addAuthorField(){this.bookForm.authors().value.update(r=>[...r,""])}isInvalid(r){return r().touched()?r().invalid():null}async submitForm(r){r.preventDefault(),await j(this.bookForm,async d=>{let e=d().value(),l=e.authors.filter(u=>!!u),m=B(E({},e),{authors:l,createdAt:new Date().toISOString()});this.#e.create(m).subscribe(u=>{this.#i.navigate(["/books","details",u.isbn])})})}static \u0275fac=function(d){return new(d||i)};static \u0275cmp=I({type:i,selectors:[["app-book-create-page"]],decls:35,vars:26,consts:[[3,"submit"],["for","title"],["type","text","id","title",3,"field","aria-invalid"],["id","title-error"],["for","subtitle"],["type","text","id","subtitle",3,"field"],["for","isbn"],["type","text","id","isbn",3,"field","aria-invalid"],["id","isbn-error"],["type","button",3,"click"],["role","group"],["type","text",3,"aria-label","field","aria-invalid"],["id","authors-error"],["for","description"],["id","description",3,"field","aria-invalid"],["id","description-error"],["for","imageUrl"],["type","url","id","imageUrl",3,"field","aria-invalid"],["id","image-url-error"],["type","submit",3,"disabled","aria-busy"]],template:function(d,e){if(d&1){let l=U();t(0,"h1"),a(1,"Create book"),o(),t(2,"form",0),F("submit",function(u){return y(l),h(e.submitForm(u))}),t(3,"label",1),a(4,"Title"),o(),t(5,"input",2),c(),o(),v(6,K,2,0,"small",3),t(7,"label",4),a(8,"Subtitle"),o(),t(9,"input",5),c(),o(),t(10,"label",6),a(11,"ISBN"),o(),t(12,"input",7),c(),o(),v(13,Q,2,0,"small",8),t(14,"fieldset")(15,"legend"),a(16,"Authors"),o(),t(17,"button",9),F("click",function(){return y(l),h(e.addAuthorField())}),a(18,"Add Author"),o(),L(19),t(20,"div",10),P(21,W,1,5,"input",11,x),v(23,X,2,0,"small",12),o()(),t(24,"label",13),a(25,"Description"),o(),t(26,"textarea",14),c(),a(27,"  "),o(),v(28,Y,2,0,"small",15),t(29,"label",16),a(30,"Thumbnail URL"),o(),t(31,"input",17),c(),o(),v(32,Z,2,0,"small",18),t(33,"button",19),a(34," Save "),o()()}if(d&2){let l=e.isInvalid(e.bookForm.title);n(5),b(e.bookForm.title),s("aria-invalid",l),p("aria-describedby",l?"title-error":null),n(),f(l?6:-1),n(3),b(e.bookForm.subtitle);let m=e.isInvalid(e.bookForm.isbn);n(3),b(e.bookForm.isbn),s("aria-invalid",m),p("aria-describedby",m?"isbn-error":null),n(),f(m?13:-1),n(6);let u=R(e.isInvalid(e.bookForm.authors));n(2),w(e.bookForm.authors),n(2),f(u?23:-1);let C=e.isInvalid(e.bookForm.description);n(3),b(e.bookForm.description),s("aria-invalid",C),p("aria-describedby",C?"description-error":null),n(2),f(C?28:-1);let _=e.isInvalid(e.bookForm.imageUrl);n(3),b(e.bookForm.imageUrl),s("aria-invalid",_),p("aria-describedby",_?"image-url-error":null),n(),f(_?32:-1),n(),A("disabled",e.bookForm().invalid()),s("aria-busy",e.bookForm().submitting())}},dependencies:[O],encapsulation:2})};var ce=[{path:"",redirectTo:"create",pathMatch:"full"},{path:"create",component:g,title:"Create Book"}];export{ce as booksAdminRoutes};
