import{a as N,b as M,c as $,d as O,e as q,f as j,g as z,h as G,i as f,j as H}from"./chunk-NUTO5JUC.js";import{$ as R,A as n,B as T,F as p,H as u,I as b,J as v,K as k,L as x,M as w,N as A,O as s,P as i,Q as o,S as L,T as I,U,V as a,Z as D,_ as P,a as F,b as B,p as h,r as S,s as y,sa as V,w as E}from"./chunk-IGLFLPLA.js";function J(t,r){t&1&&(i(0,"small",3),a(1,"The title is invalid."),o())}function K(t,r){t&1&&(i(0,"small",8),a(1,"The ISBN is invalid."),o())}function Q(t,r){if(t&1&&(i(0,"input",11),u(),o()),t&2){let d=r.$implicit,e=r.$index;U();let l=R(19);s("ariaLabel",`Author ${e+1}`),b(d),s("ariaInvalid",l),p("aria-describedby",l?"authors-error":null)}}function W(t,r){t&1&&(i(0,"small",12),a(1,"At least one author must be added."),o())}function X(t,r){t&1&&(i(0,"small",15),a(1,"The description is invalid."),o())}function Y(t,r){t&1&&(i(0,"small",18),a(1,"The URL is invalid."),o())}var Z=j(t=>{f(t.title),f(t.isbn),G(t.isbn,13),z(t.isbn,13),M(t.authors,r=>r.value().some(d=>d)?void 0:N({kind:"atLeastOneAuthor"})),f(t.description),f(t.imageUrl)}),g=class t{#e=h(H);#t=h(V);#i=E({isbn:"",title:"",subtitle:"",authors:[""],description:"",imageUrl:"",createdAt:new Date().toISOString()});bookForm=O(this.#i,Z);addAuthorField(){this.bookForm.authors().value.update(r=>[...r,""])}isInvalid(r){return r().touched()?r().invalid():null}async submitForm(r){r.preventDefault(),await q(this.bookForm,async d=>{let e=d().value(),l=e.authors.filter(c=>!!c),m=B(F({},e),{authors:l,createdAt:new Date().toISOString()});this.#e.create(m).subscribe(c=>{this.#t.navigate(["/books","details",c.isbn])})})}static \u0275fac=function(d){return new(d||t)};static \u0275cmp=T({type:t,selectors:[["app-book-create-page"]],decls:35,vars:21,consts:[[3,"submit"],["for","title"],["type","text","id","title",3,"field","ariaInvalid"],["id","title-error"],["for","subtitle"],["type","text","id","subtitle",3,"field"],["for","isbn"],["type","text","id","isbn",3,"field","ariaInvalid"],["id","isbn-error"],["type","button",3,"click"],["role","group"],["type","text",3,"ariaLabel","field","ariaInvalid"],["id","authors-error"],["for","description"],["id","description",3,"field","ariaInvalid"],["id","description-error"],["for","imageUrl"],["type","url","id","imageUrl",3,"field","ariaInvalid"],["id","image-url-error"],["type","submit",3,"disabled","ariaBusy"]],template:function(d,e){if(d&1){let l=L();i(0,"h1"),a(1,"Create book"),o(),i(2,"form",0),I("submit",function(c){return S(l),y(e.submitForm(c))}),i(3,"label",1),a(4,"Title"),o(),i(5,"input",2),u(),o(),v(6,J,2,0,"small",3),i(7,"label",4),a(8,"Subtitle"),o(),i(9,"input",5),u(),o(),i(10,"label",6),a(11,"ISBN"),o(),i(12,"input",7),u(),o(),v(13,K,2,0,"small",8),i(14,"fieldset")(15,"legend"),a(16,"Authors"),o(),i(17,"button",9),I("click",function(){return S(l),y(e.addAuthorField())}),a(18,"Add Author"),o(),D(19),i(20,"div",10),w(21,Q,1,4,"input",11,x),v(23,W,2,0,"small",12),o()(),i(24,"label",13),a(25,"Description"),o(),i(26,"textarea",14),u(),a(27,"  "),o(),v(28,X,2,0,"small",15),i(29,"label",16),a(30,"Thumbnail URL"),o(),i(31,"input",17),u(),o(),v(32,Y,2,0,"small",18),i(33,"button",19),a(34," Save "),o()()}if(d&2){let l=e.isInvalid(e.bookForm.title);n(5),b(e.bookForm.title),s("ariaInvalid",l),p("aria-describedby",l?"title-error":null),n(),k(l?6:-1),n(3),b(e.bookForm.subtitle);let m=e.isInvalid(e.bookForm.isbn);n(3),b(e.bookForm.isbn),s("ariaInvalid",m),p("aria-describedby",m?"isbn-error":null),n(),k(m?13:-1),n(6);let c=P(e.isInvalid(e.bookForm.authors));n(2),A(e.bookForm.authors),n(2),k(c?23:-1);let C=e.isInvalid(e.bookForm.description);n(3),b(e.bookForm.description),s("ariaInvalid",C),p("aria-describedby",C?"description-error":null),n(2),k(C?28:-1);let _=e.isInvalid(e.bookForm.imageUrl);n(3),b(e.bookForm.imageUrl),s("ariaInvalid",_),p("aria-describedby",_?"image-url-error":null),n(),k(_?32:-1),n(),s("disabled",e.bookForm().invalid())("ariaBusy",e.bookForm().submitting())}},dependencies:[$],encapsulation:2})};var ce=[{path:"",redirectTo:"create",pathMatch:"full"},{path:"create",component:g,title:"Create Book"}];export{ce as booksAdminRoutes};
